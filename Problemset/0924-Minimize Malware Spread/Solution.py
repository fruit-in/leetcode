class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        n = len(graph)
        initial = set(initial)
        parent = list(range(n))
        count = {}
        uninfected = 0
        ret = min(initial)

        for i in range(n):
            for j in range(n):
                if graph[i][j] == 1:
                    while parent[i] != parent[parent[i]]:
                        parent[i] = parent[parent[i]]
                    while parent[j] != parent[parent[j]]:
                        parent[j] = parent[parent[j]]
                    if parent[i] < parent[j]:
                        parent[parent[j]] = parent[i]
                    else:
                        parent[parent[i]] = parent[j]

        for i in range(n):
            while parent[i] != parent[parent[i]]:
                parent[i] = parent[parent[i]]
            if parent[i] not in count:
                count[parent[i]] = [0, 0]
            count[parent[i]][0] += 1
            count[parent[i]][1] += i in initial

        for i in sorted(initial):
            if count[parent[i]][1] < 2 and count[parent[i]][0] > uninfected:
                uninfected = count[parent[i]][0]
                ret = i

        return ret
